<!--
Load the web component libraries
-->
<link href="./cube-element-import.html" rel="import">

<link href="../polymer/polymer.html" rel="import">
<link href="../paper-button/paper-button.html" rel="import">
<link href="../font-roboto/roboto.html" rel="import">

<!--
Main element code
-->
<polymer-element
    name="cube-element"
    attributes="height width initmove initrevmove demo">
    <template>
        <link rel="stylesheet" type="text/css" href="./styles/cube.css">
        <link rel="stylesheet" type="text/css" href="./styles/base.css">

        <style shim-shadowdom>
            #cubeContainer {
                height: {{ height }};
                width:  {{ width }};
            }

            paper-button {
                font-family: RobotoDraft;
                width: auto;
            }

            #reset-button {
                background: #4285f4;
                color: #fff;
            }
            #reset-button:hover {
                background: #2a56c6;
            }
        </style>

        <div id="cubeContainer">
        </div>
        <paper-button id="reset-button" label="Reset" raisedButton></paper-button>
        <paper-button id="play-button" label="Play" raisedButton></paper-button>
        
    
    </template>
    <script>
        Polymer('cube-element', {
            // parameters
            height: "300px",
            width:  "300px",

            // callback
            ready: function(){

                var useLockedControls = true,
                    controls = useLockedControls ? ERNO.Locked : ERNO.Freeform;

                var cube = new ERNO.Cube({
                    hideInvisibleFaces: false,
                    controls: controls,
                });

                this.$.cubeContainer.appendChild( cube.domElement );

                if( controls === ERNO.Locked ){
                    var fixedOrientation = new THREE.Euler(  Math.PI * 0.1, Math.PI * -0.25, 0 );
                    cube.object3D.lookAt( cube.camera.position );
                    cube.rotation.x += fixedOrientation.x;
                    cube.rotation.y += fixedOrientation.y;
                    cube.rotation.z += fixedOrientation.z;
                }
                
                // calculate the algo to revert cube
                var reverseTwist = this.demo.reverse().invert();


                // TODO: facelets

                // TODO: initrevmove, initmove
                for ( var i = 0 ; i < reverseTwist.length ; i++ ) {
                    var step = reverseTwist[i]
                    var stepTwist = new ERNO.Twist(step);

                    cube.immediateTwist(stepTwist);
                }

            }
        });
    
    </script>
</polymer-element>
